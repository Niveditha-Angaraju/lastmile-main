[1;34m[INFO][0m Registry: lastmile  Tag: latest  PUSH: false  MINIKUBE_LOAD: false
[1;34m[INFO][0m Building lastmile/gateway-service:latest from services/gateway_service/Dockerfile ...
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            BuildKit is currently disabled; enable it by removing the DOCKER_BUILDKIT=0
            environment-variable.

Sending build context to Docker daemon  572.4kB
Step 1/11 : FROM nivedithavarma/lastmile-python-base:3.11
 ---> 8313960f0db6
Step 2/11 : ENV PORT=8000     PYTHONPATH=/app     PYTHONUNBUFFERED=1     PIP_NO_CACHE_DIR=1
 ---> Using cache
 ---> b6f506b913dd
Step 3/11 : WORKDIR /app
 ---> Using cache
 ---> c06ed0ef90b2
Step 4/11 : COPY services/gateway_service/requirements.txt /app/requirements.txt
 ---> Using cache
 ---> 73c2c92d52fe
Step 5/11 : USER root
 ---> Using cache
 ---> 6bd828827083
Step 6/11 : RUN python -m pip install --upgrade pip setuptools wheel  && python -m pip install --no-cache-dir -r /app/requirements.txt
 ---> Using cache
 ---> 05fd115ad4c5
Step 7/11 : USER app
 ---> Using cache
 ---> 803f26057530
Step 8/11 : COPY services/gateway_service /app/services/gateway_service
 ---> Using cache
 ---> 79906cf86a0c
Step 9/11 : EXPOSE 8000
 ---> Using cache
 ---> 59e5eeb857c2
Step 10/11 : HEALTHCHECK --interval=30s --timeout=3s --start-period=10s --retries=3   CMD curl -f http://127.0.0.1:8000/healthz || exit 1
 ---> Using cache
 ---> 8a849a6b4c34
Step 11/11 : CMD ["uvicorn","services.gateway_service.app:app","--host","0.0.0.0","--port","8000"]
 ---> Using cache
 ---> 548a5aa9503a
Successfully built 548a5aa9503a
Successfully tagged lastmile/gateway-service:latest
[1;34m[INFO][0m Building lastmile/trip-service:latest from services/trip_service/Dockerfile ...
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            BuildKit is currently disabled; enable it by removing the DOCKER_BUILDKIT=0
            environment-variable.

Sending build context to Docker daemon  572.4kB
Step 1/12 : FROM nivedithavarma/lastmile-python-base:3.11
 ---> 8313960f0db6
Step 2/12 : ENV PORT=8007 PYTHONPATH=/app
 ---> Using cache
 ---> 469df7e00618
Step 3/12 : WORKDIR /app
 ---> Using cache
 ---> a064526bc23a
Step 4/12 : COPY services/trip_service/requirements.txt /app/requirements.txt
 ---> Using cache
 ---> 6ffe345bb367
Step 5/12 : USER root
 ---> Using cache
 ---> da72d22f7b1f
Step 6/12 : RUN python -m pip install --upgrade pip setuptools wheel  && pip install --no-cache-dir -r /app/requirements.txt
 ---> Using cache
 ---> 840b148da1fc
Step 7/12 : USER app
 ---> Using cache
 ---> 653e746714c3
Step 8/12 : COPY services/trip_service /app/services/trip_service
 ---> Using cache
 ---> 933175b760db
Step 9/12 : COPY services/common_lib/protos_generated /app/services/common_lib/protos_generated
 ---> Using cache
 ---> f29a0dc26b59
Step 10/12 : EXPOSE 8007
 ---> Using cache
 ---> 15f40afb9ea3
Step 11/12 : HEALTHCHECK --interval=30s --timeout=3s --start-period=10s --retries=3 CMD python -c "import socket,os,sys,socket as _s; s=_s.socket();try: s.settimeout(2); s.connect(('127.0.0.1', int(os.getenv('PORT','8006')))); s.close(); sys.exit(0) except: sys.exit(1)"
 ---> Using cache
 ---> 23869683f29f
Step 12/12 : CMD ["python", "-u", "services/trip_service/app.py"]
 ---> Using cache
 ---> a8c1d5a6fe4f
Successfully built a8c1d5a6fe4f
Successfully tagged lastmile/trip-service:latest
[1;34m[INFO][0m Building lastmile/notification-service:latest from services/notification_service/Dockerfile ...
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            BuildKit is currently disabled; enable it by removing the DOCKER_BUILDKIT=0
            environment-variable.

Sending build context to Docker daemon  572.4kB
Step 1/12 : FROM nivedithavarma/lastmile-python-base:3.11
 ---> 8313960f0db6
Step 2/12 : ENV PORT=8006 PYTHONPATH=/app
 ---> Using cache
 ---> b7006680c308
Step 3/12 : WORKDIR /app
 ---> Using cache
 ---> aa1ad689c0a1
Step 4/12 : COPY services/notification_service/requirements.txt /app/requirements.txt
 ---> Using cache
 ---> f61fabd77032
Step 5/12 : USER root
 ---> Using cache
 ---> 8930d6d83187
Step 6/12 : RUN python -m pip install --upgrade pip setuptools wheel  && pip install --no-cache-dir -r /app/requirements.txt
 ---> Using cache
 ---> 5520cfcec2cc
Step 7/12 : USER app
 ---> Using cache
 ---> 7deb14901c4d
Step 8/12 : COPY services/notification_service /app/services/notification_service
 ---> Using cache
 ---> 5b2a57652ebd
Step 9/12 : COPY services/common_lib/protos_generated /app/services/common_lib/protos_generated
 ---> Using cache
 ---> 63bef3deb5d0
Step 10/12 : EXPOSE 8006
 ---> Using cache
 ---> 8321415d615c
Step 11/12 : HEALTHCHECK --interval=30s --timeout=3s --start-period=10s --retries=3 CMD python -c "import socket,os,sys,socket as _s; s=_s.socket();try: s.settimeout(2); s.connect(('127.0.0.1', int(os.getenv('PORT','8006')))); s.close(); sys.exit(0) except: sys.exit(1)"
 ---> Using cache
 ---> 96511050a1f6
Step 12/12 : CMD ["python", "-u", "services/notification_service/app.py"]
 ---> Using cache
 ---> b2b962219d6a
Successfully built b2b962219d6a
Successfully tagged lastmile/notification-service:latest
[1;34m[INFO][0m Building lastmile/driver-service:latest from services/driver_service/Dockerfile ...
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            BuildKit is currently disabled; enable it by removing the DOCKER_BUILDKIT=0
            environment-variable.

Sending build context to Docker daemon  572.4kB
Step 1/12 : FROM nivedithavarma/lastmile-python-base:3.11
 ---> 8313960f0db6
Step 2/12 : ENV PORT=50052 PYTHONPATH=/app
 ---> Using cache
 ---> 57871fdb3e26
Step 3/12 : WORKDIR /app
 ---> Using cache
 ---> 62e8b76cd727
Step 4/12 : COPY services/driver_service/requirements.txt /app/requirements.txt
 ---> Using cache
 ---> ffdcd362c8ae
Step 5/12 : USER root
 ---> Using cache
 ---> 282b6a97a3df
Step 6/12 : RUN python -m pip install --upgrade pip setuptools wheel  && pip install --no-cache-dir -r /app/requirements.txt
 ---> Using cache
 ---> 4dfbef77baec
Step 7/12 : USER app
 ---> Using cache
 ---> 7b4560f2113b
Step 8/12 : COPY services/driver_service /app/services/driver_service
 ---> Using cache
 ---> d1337b6476fe
Step 9/12 : COPY services/common_lib/protos_generated /app/services/common_lib/protos_generated
 ---> Using cache
 ---> aca0942f2379
Step 10/12 : EXPOSE 50052
 ---> Using cache
 ---> 69295f9781ee
Step 11/12 : HEALTHCHECK --interval=30s --timeout=3s --start-period=10s --retries=3 CMD python -c "import socket,os,sys;s=socket.socket();try: s.settimeout(2); s.connect(('127.0.0.1', int(os.getenv('PORT','50052')))); s.close(); sys.exit(0) except: sys.exit(1)"
 ---> Using cache
 ---> 80fc62a6fd2d
Step 12/12 : CMD ["python", "-u", "services/driver_service/app.py"]
 ---> Using cache
 ---> 24340fd8868d
Successfully built 24340fd8868d
Successfully tagged lastmile/driver-service:latest
[1;34m[INFO][0m Building lastmile/matching-service:latest from services/matching_service/Dockerfile ...
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            BuildKit is currently disabled; enable it by removing the DOCKER_BUILDKIT=0
            environment-variable.

Sending build context to Docker daemon  572.4kB
Step 1/12 : FROM nivedithavarma/lastmile-python-base:3.11
 ---> 8313960f0db6
Step 2/12 : ENV PORT=8004 PYTHONPATH=/app
 ---> Using cache
 ---> dbba4c54de26
Step 3/12 : WORKDIR /app
 ---> Using cache
 ---> 2a07119c86ff
Step 4/12 : COPY services/matching_service/requirements.txt /app/requirements.txt
 ---> Using cache
 ---> 59a36577758f
Step 5/12 : USER root
 ---> Using cache
 ---> 599b30a79ea7
Step 6/12 : RUN python -m pip install --upgrade pip setuptools wheel  && pip install --no-cache-dir -r /app/requirements.txt
 ---> Using cache
 ---> 5a6ab9abf720
Step 7/12 : USER app
 ---> Using cache
 ---> cc0eaa4daace
Step 8/12 : COPY services/matching_service /app/services/matching_service
 ---> Using cache
 ---> b8a1945182f9
Step 9/12 : COPY services/common_lib/protos_generated /app/services/common_lib/protos_generated
 ---> Using cache
 ---> 82cdd7803968
Step 10/12 : EXPOSE 8004
 ---> Using cache
 ---> e2e48851076c
Step 11/12 : HEALTHCHECK --interval=30s --timeout=3s --start-period=10s --retries=3 CMD python -c "import socket,os,sys;s=socket.socket();try: s.settimeout(2); s.connect(('127.0.0.1', int(os.getenv('PORT','8004')))); s.close(); sys.exit(0) except: sys.exit(1)"
 ---> Using cache
 ---> 26bf53c0dae8
Step 12/12 : CMD ["python", "-u", "services/matching_service/app.py"]
 ---> Using cache
 ---> bac26ceee754
Successfully built bac26ceee754
Successfully tagged lastmile/matching-service:latest
[1;34m[INFO][0m Building lastmile/rider-service:latest from services/rider_service/Dockerfile ...
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            BuildKit is currently disabled; enable it by removing the DOCKER_BUILDKIT=0
            environment-variable.

Sending build context to Docker daemon  572.4kB
Step 1/12 : FROM nivedithavarma/lastmile-python-base:3.11
 ---> 8313960f0db6
Step 2/12 : ENV PORT=8002 PYTHONPATH=/app
 ---> Using cache
 ---> d01a6fe1f32f
Step 3/12 : WORKDIR /app
 ---> Using cache
 ---> ee390eb9ec4c
Step 4/12 : COPY services/rider_service/requirements.txt /app/requirements.txt
 ---> Using cache
 ---> ff9db81f2b9b
Step 5/12 : USER root
 ---> Using cache
 ---> 45cb550645bc
Step 6/12 : RUN python -m pip install --upgrade pip setuptools wheel  && pip install --no-cache-dir -r /app/requirements.txt
 ---> Using cache
 ---> a122afbda561
Step 7/12 : USER app
 ---> Using cache
 ---> a3f914b936c6
Step 8/12 : COPY services/rider_service /app/services/rider_service
 ---> Using cache
 ---> c33a5c69912c
Step 9/12 : COPY services/common_lib/protos_generated /app/services/common_lib/protos_generated
 ---> Using cache
 ---> 79ad538445ed
Step 10/12 : EXPOSE 8002
 ---> Using cache
 ---> a87bd6b994d4
Step 11/12 : HEALTHCHECK --interval=30s --timeout=3s --start-period=10s --retries=3 CMD python -c "import socket,os,sys;s=socket.socket();try: s.settimeout(2); s.connect(('127.0.0.1', int(os.getenv('PORT','8002')))); s.close(); sys.exit(0) except: sys.exit(1)"
 ---> Using cache
 ---> 7d887c4153c1
Step 12/12 : CMD ["python", "-u", "services/rider_service/app.py"]
 ---> Using cache
 ---> e18dd41c0575
Successfully built e18dd41c0575
Successfully tagged lastmile/rider-service:latest
[1;34m[INFO][0m Building lastmile/location-service:latest from services/location_service/Dockerfile ...
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            BuildKit is currently disabled; enable it by removing the DOCKER_BUILDKIT=0
            environment-variable.

Sending build context to Docker daemon  572.4kB
Step 1/12 : FROM nivedithavarma/lastmile-python-base:3.11
 ---> 8313960f0db6
Step 2/12 : ENV PORT=50053 PYTHONPATH=/app
 ---> Using cache
 ---> 817569ee8d6e
Step 3/12 : WORKDIR /app
 ---> Using cache
 ---> df55a8537d60
Step 4/12 : COPY services/location_service/requirements.txt /app/requirements.txt
 ---> Using cache
 ---> 32905ed847e6
Step 5/12 : USER root
 ---> Using cache
 ---> abcf0a78c376
Step 6/12 : RUN python -m pip install --upgrade pip setuptools wheel  && pip install --no-cache-dir -r /app/requirements.txt
 ---> Using cache
 ---> 034cf0de3435
Step 7/12 : USER app
 ---> Using cache
 ---> d0f4faf191c8
Step 8/12 : COPY services/location_service /app/services/location_service
 ---> Using cache
 ---> 28e4061b4ff1
Step 9/12 : COPY services/common_lib/protos_generated /app/services/common_lib/protos_generated
 ---> Using cache
 ---> 0b6173b3389d
Step 10/12 : EXPOSE 50053
 ---> Using cache
 ---> dcde0901b7f5
Step 11/12 : HEALTHCHECK --interval=30s --timeout=3s --start-period=10s --retries=3 CMD python -c "import socket,os,sys;s=socket.socket();try: s.settimeout(2); s.connect(('127.0.0.1', int(os.getenv('PORT','50053')))); s.close(); sys.exit(0) except: sys.exit(1)"
 ---> Using cache
 ---> b2c6938d8e3a
Step 12/12 : CMD ["python", "-u", "services/location_service/app.py"]
 ---> Using cache
 ---> 9ce700c3164c
Successfully built 9ce700c3164c
Successfully tagged lastmile/location-service:latest
[1;34m[INFO][0m Building lastmile/station-service:latest from services/station_service/Dockerfile ...
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            BuildKit is currently disabled; enable it by removing the DOCKER_BUILDKIT=0
            environment-variable.

Sending build context to Docker daemon  572.4kB
Step 1/12 : FROM nivedithavarma/lastmile-python-base:3.11
 ---> 8313960f0db6
Step 2/12 : ENV PORT=8005 PYTHONPATH=/app
 ---> Using cache
 ---> dbb3de5109ae
Step 3/12 : WORKDIR /app
 ---> Using cache
 ---> 1633bf24d985
Step 4/12 : COPY services/station_service/requirements.txt /app/requirements.txt
 ---> Using cache
 ---> 8f6c598b1dbe
Step 5/12 : USER root
 ---> Using cache
 ---> 1ace853deadf
Step 6/12 : RUN python -m pip install --upgrade pip setuptools wheel  && pip install --no-cache-dir -r /app/requirements.txt
 ---> Using cache
 ---> e8f3465007f6
Step 7/12 : USER app
 ---> Using cache
 ---> 80b398a7679d
Step 8/12 : COPY services/station_service /app/services/station_service
 ---> Using cache
 ---> 8e627f9b413a
Step 9/12 : COPY services/common_lib/protos_generated /app/services/common_lib/protos_generated
 ---> Using cache
 ---> cfc8b3a4533c
Step 10/12 : EXPOSE 8005
 ---> Using cache
 ---> e6bb40bf80a9
Step 11/12 : HEALTHCHECK --interval=30s --timeout=3s --start-period=10s --retries=3 CMD python -c "import socket,os,sys;s=socket.socket();try: s.settimeout(2); s.connect(('127.0.0.1', int(os.getenv('PORT','8005')))); s.close(); sys.exit(0) except: sys.exit(1)"
 ---> Using cache
 ---> 1923b7821993
Step 12/12 : CMD ["python", "-u", "services/station_service/app.py"]
 ---> Using cache
 ---> 66170b034b22
Successfully built 66170b034b22
Successfully tagged lastmile/station-service:latest
[1;34m[INFO][0m Building lastmile/user-service:latest from services/user_service/Dockerfile ...
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            BuildKit is currently disabled; enable it by removing the DOCKER_BUILDKIT=0
            environment-variable.

Sending build context to Docker daemon  572.4kB
Step 1/12 : FROM nivedithavarma/lastmile-python-base:3.11
 ---> 8313960f0db6
Step 2/12 : ENV PORT=8001 PYTHONPATH=/app
 ---> Using cache
 ---> 4d06801193e3
Step 3/12 : WORKDIR /app
 ---> Using cache
 ---> 173837e6992f
Step 4/12 : COPY services/user_service/requirements.txt /app/requirements.txt
 ---> Using cache
 ---> 31d09dd3c23d
Step 5/12 : USER root
 ---> Using cache
 ---> 8493bdeda792
Step 6/12 : RUN python -m pip install --upgrade pip setuptools wheel  && pip install --no-cache-dir -r /app/requirements.txt
 ---> Using cache
 ---> 088ad185739b
Step 7/12 : USER app
 ---> Using cache
 ---> e26c29443f43
Step 8/12 : COPY services/user_service /app/services/user_service
 ---> Using cache
 ---> fc3e88c398c7
Step 9/12 : COPY services/common_lib/protos_generated /app/services/common_lib/protos_generated
 ---> Using cache
 ---> 270a52087973
Step 10/12 : EXPOSE 8001
 ---> Using cache
 ---> c71ff44327d6
Step 11/12 : HEALTHCHECK --interval=30s --timeout=3s --start-period=10s --retries=3 CMD python -c "import socket,os,sys;s=socket.socket();try: s.settimeout(2); s.connect(('127.0.0.1', int(os.getenv('PORT','8001')))); s.close(); sys.exit(0) except: sys.exit(1)"
 ---> Using cache
 ---> 212d3bc56344
Step 12/12 : CMD ["python", "-u", "services/user_service/app.py"]
 ---> Using cache
 ---> 6ec01aa7aa43
Successfully built 6ec01aa7aa43
Successfully tagged lastmile/user-service:latest
[1;34m[INFO][0m Done. Built images:
lastmile/user-service                 latest            545MB
lastmile/station-service              latest            547MB
lastmile/location-service             latest            547MB
lastmile/rider-service                latest            547MB
lastmile/matching-service             latest            510MB
lastmile/driver-service               latest            510MB
lastmile/trip-service                 latest            547MB
lastmile/gateway-service              latest            513MB
lastmile/notification-service         latest            510MB
lastmile/python-base                  3.11              481MB

USAGE NOTES:
 - Run from repo root: ./build_all.sh
 - To push to Docker Hub (or other registry), set REG and PUSH=true:
     REG=yourdockerhubusername ./build_all.sh PUSH=true TAG=0.1.0
 - To load into minikube (no push needed):
     ./build_all.sh LOAD_MINIKUBE=true
   or:
     REG=lastmile ./build_all.sh LOAD_MINIKUBE=true
 - To load into kind:
     ./build_all.sh LOAD_KIND=true KIND_CLUSTER=kind
 - If you get permission denied pushing, run: docker login
 - The script uses BuildKit by default; if you prefer legacy builder unset DOCKER_BUILDKIT.

